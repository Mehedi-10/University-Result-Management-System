{% extends 'base3.html' %}
{% block title %}{{ 'Manage result' }}{% endblock %}
{% block style_content %}
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/teacherresult.css' %}">
    <link rel="stylesheet" href="{% static 'css/spreadsheet.css' %}">
{% endblock %}
{% block icone %}{% endblock %}
{% block content %}
    <div style="text-align: center ;padding-top: 17px; font-size: 19px">

        Comilla University </br>
        Department of Computer Science & Engineering</br>
        Class: 3rd year 1st Semester final 2018 &nbsp; Session: 2018-19</br>
        Course Title: Theory of Computition</br>
        Course Code: CSE-3103 &nbsp; Full Marks: 40</br>
        Before Final
    </div>
    <hr>
    <div id="hehe" style="height: 67vh; width: max-content;display: block;margin: auto;">
        <form id="po" method="POST" action="">
            {% csrf_token %}
            <table>
                <tr style="width:100%;">
                    <td></td>
                    <td id="hello">A</td>
                    <td id="hello">B</td>
                    <td id="hello">C</td>
                    <td id="hello">D</td>
                    <td id="hello">E</td>
                    <td id="hello">F</td>
                    <td id="hello">G</td>
                    <td id="hello">H</td>
                    <td id="hello">I</td>
                    <td id="hello">J</td>
                </tr>
                {% for i,val in cons.items %}
                    <tr>
                        <td id="hello">
                            {{ i }}
                        </td>
                        <td><input id="{{ i }}{{ 'A' }}" name="{{ i }}{{ 'A' }}" class="spreadsheets" type="text"
                                   value="{{ val.Student_id }}"></td>
                        <td><input id="{{ i }}{{ 'B' }}" name="{{ i }}{{ 'B' }}" class="spreadsheets" type="text"
                                   value="{{ val.A }}"></td>
                        <td><input id="{{ i }}{{ 'C' }}" name="{{ i }}{{ 'C' }}" class="spreadsheets" type="text"
                                   value="{{ val.B }}"></td>
                        <td><input id="{{ i }}{{ 'D' }}" name="{{ i }}{{ 'D' }}" class="spreadsheets" type="text"
                                   value="{{ val.C }}"></td>
                        <td><input id="{{ i }}{{ 'E' }}" name="{{ i }}{{ 'E' }}" class="spreadsheets" type="text"
                                   value="{{ val.D }}"></td>
                        <td><input id="{{ i }}{{ 'F' }}" name="{{ i }}{{ 'F' }}" class="spreadsheets" type="text"
                                   value="{{ val.E }}"></td>
                        <td><input id="{{ i }}{{ 'G' }}" name="{{ i }}{{ 'G' }}" class="spreadsheets" type="text"
                                   value="{{ val.F }}"></td>
                        <td><input id="{{ i }}{{ 'H' }}" name="{{ i }}{{ 'H' }}" class="spreadsheets" type="text"
                                   value="{{ val.G }}"></td>
                        <td><input id="{{ i }}{{ 'I' }}" name="{{ i }}{{ 'I' }}" class="spreadsheets" type="text"
                                   value="{{ val.H }}"></td>
                        <td><input id="{{ i }}{{ 'J' }}" name="{{ i }}{{ 'J' }}" class="spreadsheets" type="text"
                                   value="{{ val.I }}"></td>

                    </tr>
                {% endfor %}
            </table>
        </form>
    </div>
    <div class="row" id="vanish" style="margin: 0px; padding-bottom: 11px;padding-top: 11px;">
        <div class="col" style="padding-left: 100px ;text-align: left">
            <input type="button" id="btn" value="export" onclick="window.print()">
        </div>
        <div class="col" style="padding-right: 100px ;text-align: right">
            <input type="button" id="onceclickable" value="submit">
        </div>
    </div>

    <p id="demo"></p>
{% endblock %}
{% block script %}
    <script>


        $('.spreadsheets').keydown(function (e) {
            if (e.which === 13) {
                var x = 1, y = $('.spreadsheets').index(this);
                if (y % 10 == 9)
                    x++;
                var index = $('.spreadsheets').index(this) + x;
                $('.spreadsheets').eq(index).focus();
            }
        });


        const button = document.querySelector('#onceclickable');


        for (let i = 0; i < 900; i++) {

            for (let j = 65; j < 75; j++) {
                var x = i.toString();
                x += String.fromCharCode(j);
                try {
                    const inp = document.getElementById(x);
                    inp.addEventListener("input", myFunction);
                    if(inp.value==='None' && x[0]>'0')
                        inp.value='0';

                    var url = "nothing"; // the script where you handle the form input.

                    function myFunction() {
                        $.ajax({
                            type: "POST",
                            url: url,
                            data: $("#po").serialize(),
                        });
                        var  ss=inp.id,sx=inp.value;
                        console.log(ss);
                        console.log(sx.slice(-1))
                        var ll=sx.length;
                        if(ss[0]!=='0'  && (sx[ll-1]<'0' || sx[ll-1]>'9'))
                        {
                            alert('Oops sorry!!! Please Insert Only Numbers at cell '+ss);
                            sx=sx.slice(0,-1);
                        }
                        inp.value=sx;
                        {#document.getElementById('demo').innerHTML = inp.value;#}
                    }

                } catch (e) {

                }

            }
        }



        const disableButton = () => {
            document.getElementById('po').submit();
            button.disabled = true;
            button.value = "submitted";
            const bu = document.getElementById('hehe')
            for (let i = 0; i < 900; i++) {
                bu.getElementsByClassName('spreadsheets')[i].disabled = true;
            }
        };
        document.getElementById('0A').disabled = true;
        button.addEventListener('click', disableButton);


    </script>
{% endblock %}
